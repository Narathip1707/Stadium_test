# üèóÔ∏è Sports Booking System - Class Diagram (Based on Actual Code)

**Class Diagram ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Model classes ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏à‡∏£‡∏¥‡∏á**

---

## üìã **PlantUML Code - Actual Implementation**

```plantuml
@startuml SportsBookingDetailedClassDiagram
!theme plain
skinparam linetype ortho
skinparam classAttributeIconSize 0

' ===================================
' User Class - ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (Customer + Admin)
' ===================================
class User {
    ' Attributes with Length, Keys
    - id : int {PK} <<auto_increment>>
    - username : String(50) {CK} <<unique>>
    - email : String(100) {CK} <<unique>>
    - phone : String(20)
    - firstName : String(100) <<not null>>
    - lastName : String(100) <<not null>>
    - password : String(255) <<not null>>
    - isAdmin : boolean <<default: false>>
    - createdAt : Timestamp <<default: CURRENT_TIMESTAMP>>
    - updatedAt : Timestamp <<on update>>
    ..
    ' Getter Methods
    + getId() : int
    + getUsername() : String
    + getEmail() : String
    + getPhone() : String
    + getFirstName() : String
    + getLastName() : String
    + getPassword() : String
    + getIsAdmin() : boolean
    + isAdmin() : boolean
    ..
    ' Setter Methods
    + setId(id : int) : void
    + setUsername(username : String) : void
    + setEmail(email : String) : void
    + setPhone(phone : String) : void
    + setFirstName(firstName : String) : void
    + setLastName(lastName : String) : void
    + setPassword(password : String) : void
    + setAdmin(isAdmin : boolean) : void
    + setIsAdmin(isAdmin : boolean) : void
    ..
    ' Business Methods
    + getFullName() : String
    + isValid() : boolean
    + toString() : String
    + validateUsername() : boolean
    + validateEmail() : boolean
    + validatePassword() : boolean
    + hasAdminPrivileges() : boolean
}

' ===================================
' Field Class - ‡∏™‡∏ô‡∏≤‡∏°‡∏Å‡∏µ‡∏¨‡∏≤
' ===================================
class Field {
    ' Attributes with Length, Keys
    - id : int {PK} <<auto_increment>>
    - fieldType : String(50) <<not null>>
    - name : String(100) {CK} <<unique>>
    - description : Text(2000)
    - price : double(10,2) <<not null>>
    - location : String(200)
    - imageUrl : String(500)
    - status : String(20) <<default: "available">>
    - capacity : int <<default: 0>>
    - operatingHours : String(50)
    - createdAt : Timestamp <<default: CURRENT_TIMESTAMP>>
    - updatedAt : Timestamp <<on update>>
    ..
    ' Getter Methods
    + getId() : int
    + getFieldType() : String
    + getName() : String
    + getDescription() : String
    + getPrice() : double
    + getLocation() : String
    + getImageUrl() : String
    + getStatus() : String
    + getCapacity() : int
    + getOperatingHours() : String
    ..
    ' Setter Methods
    + setId(id : int) : void
    + setFieldType(fieldType : String) : void
    + setName(name : String) : void
    + setDescription(description : String) : void
    + setPrice(price : double) : void
    + setLocation(location : String) : void
    + setImageUrl(imageUrl : String) : void
    + setStatus(status : String) : void
    + setCapacity(capacity : int) : void
    + setOperatingHours(operatingHours : String) : void
    ..
    ' Business Methods
    + isAvailable() : boolean
    + checkAvailability(date : Date, startTime : Time, endTime : Time) : boolean
    + calculatePrice(hours : int) : double
    + updateStatus(status : String) : void
    + isActive() : boolean
    + toString() : String
}

' ===================================
' Booking Class - ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏ô‡∏≤‡∏°
' ===================================
class Booking {
    ' Attributes with Length, Keys
    - bookingId : int {PK} <<auto_increment>>
    - userId : int {FK} <<references User(id)>>
    - bookingDate : Date <<not null>>
    - startTime : Time <<not null>>
    - endTime : Time <<not null>>
    - status : String(20) <<default: "pending">>
    - fieldType : String(50) <<not null>>
    - totalPrice : int <<not null>>
    - createdAt : Timestamp <<default: CURRENT_TIMESTAMP>>
    - paymentStatus : String(20) <<default: "unpaid">>
    - updatedAt : Timestamp <<on update>>
    ..
    ' Getter Methods
    + getBookingId() : int
    + getUserId() : int
    + getBookingDate() : Date
    + getStartTime() : Time
    + getEndTime() : Time
    + getStatus() : String
    + getFieldType() : String
    + getTotalPrice() : int
    + getCreatedAt() : Timestamp
    + getPaymentStatus() : String
    ..
    ' Setter Methods
    + setBookingId(bookingId : int) : void
    + setUserId(userId : int) : void
    + setBookingDate(bookingDate : Date) : void
    + setStartTime(startTime : Time) : void
    + setEndTime(endTime : Time) : void
    + setStatus(status : String) : void
    + setFieldType(fieldType : String) : void
    + setTotalPrice(totalPrice : int) : void
    + setCreatedAt(createdAt : Timestamp) : void
    + setPaymentStatus(paymentStatus : String) : void
    ..
    ' Business Methods
    + calculateDuration() : int
    + validateBookingTime() : boolean
    + isOverlapping(otherBooking : Booking) : boolean
    + isPending() : boolean
    + isConfirmed() : boolean
    + isCancelled() : boolean
    + isPaid() : boolean
    + cancel() : boolean
    + confirm() : boolean
    + toString() : String
}

' ===================================
' Payment Class - ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
' ===================================
class Payment {
    ' Attributes with Length, Keys
    - paymentId : int {PK} <<auto_increment>>
    - bookingId : int {FK} <<references Booking(bookingId)>>
    - amount : double(10,2) <<not null>>
    - paymentMethod : String(30) <<not null>>
    - transactionId : String(100) {CK} <<unique>>
    - paymentStatus : String(20) <<default: "pending">>
    - paymentDate : Timestamp <<default: CURRENT_TIMESTAMP>>
    - createdAt : Timestamp <<default: CURRENT_TIMESTAMP>>
    - updatedAt : Timestamp <<on update>>
    ..
    ' Getter Methods
    + getPaymentId() : int
    + getBookingId() : int
    + getAmount() : double
    + getPaymentMethod() : String
    + getTransactionId() : String
    + getPaymentStatus() : String
    + getPaymentDate() : Timestamp
    ..
    ' Setter Methods
    + setPaymentId(paymentId : int) : void
    + setBookingId(bookingId : int) : void
    + setAmount(amount : double) : void
    + setPaymentMethod(paymentMethod : String) : void
    + setTransactionId(transactionId : String) : void
    + setPaymentStatus(paymentStatus : String) : void
    + setPaymentDate(paymentDate : Timestamp) : void
    ..
    ' Business Methods
    + processPayment() : boolean
    + verifyPayment() : boolean
    + isPending() : boolean
    + isCompleted() : boolean
    + isFailed() : boolean
    + refund() : boolean
    + generateTransactionId() : String
    + validateAmount() : boolean
    + toString() : String
}

' =========== RELATIONSHIPS WITH MULTIPLICITY ===========

' User to Booking Relationship (One User can make Many Bookings)
User "1" --o{ "0..*" Booking : makes >
Booking }o-- User : belongs to

' Booking to Payment Relationship (One Booking can have One Payment)
Booking "1" --o| "0..1" Payment : has >
Payment |o-- Booking : for

' =========== FOREIGN KEY LINKS ===========
User ||..|| Booking : userId {FK}
Booking ||..|| Payment : bookingId {FK}

' =========== NOTES & CONSTRAINTS ===========

note right of User
  **User Role Management:**
  ‚Ä¢ isAdmin = true ‚Üí System Administrator
  ‚Ä¢ isAdmin = false ‚Üí Regular Customer
  
  **Constraints:**
  ‚Ä¢ username: 4-50 characters, unique
  ‚Ä¢ email: valid email format, unique
  ‚Ä¢ password: minimum 8 characters
  ‚Ä¢ firstName & lastName: required
  
  **Default Behavior:**
  ‚Ä¢ New users are customers by default
  ‚Ä¢ Timestamps auto-managed
end note

note right of Field
  **Field Status Values:**
  ‚Ä¢ "available" - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
  ‚Ä¢ "maintenance" - ‡∏õ‡∏¥‡∏î‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á
  ‚Ä¢ "reserved" - ‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß
  ‚Ä¢ "inactive" - ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
  
  **Constraints:**
  ‚Ä¢ name: unique field name
  ‚Ä¢ price: must be > 0
  ‚Ä¢ capacity: integer >= 0
  
  **Business Rules:**
  ‚Ä¢ Operating hours format: "HH:MM-HH:MM"
  ‚Ä¢ Image URL can store multiple images (comma-separated)
end note

note right of Booking
  **Booking Status Values:**
  ‚Ä¢ "pending" - ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
  ‚Ä¢ "confirmed" - ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß
  ‚Ä¢ "cancelled" - ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
  ‚Ä¢ "completed" - ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô
  
  **Payment Status Values:**
  ‚Ä¢ "unpaid" - ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏à‡πà‡∏≤‡∏¢
  ‚Ä¢ "paid" - ‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß
  ‚Ä¢ "refunded" - ‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß
  
  **Constraints:**
  ‚Ä¢ endTime must be after startTime
  ‚Ä¢ bookingDate cannot be in the past
  ‚Ä¢ totalPrice must be > 0
  
  **Note:**
  ‚Ä¢ fieldType references Field.fieldType
  ‚Ä¢ No direct FK constraint to Field table
end note

note right of Payment
  **Payment Method Values:**
  ‚Ä¢ "qrCode" - QR Code Payment
  ‚Ä¢ "bankTransfer" - Bank Transfer
  ‚Ä¢ "creditCard" - Credit Card
  ‚Ä¢ "cash" - Cash Payment
  
  **Payment Status Values:**
  ‚Ä¢ "pending" - ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
  ‚Ä¢ "completed" - ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
  ‚Ä¢ "failed" - ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
  ‚Ä¢ "refunded" - ‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß
  
  **Constraints:**
  ‚Ä¢ transactionId: unique identifier
  ‚Ä¢ amount must match Booking.totalPrice
  ‚Ä¢ paymentMethod is required
  
  **Business Rules:**
  ‚Ä¢ Transaction ID generated from payment gateway
  ‚Ä¢ Payment date auto-set on successful payment
end note

@enduml
```

---

## üìä **Detailed Database Schema**

### **Table: users**
| Column | Data Type | Length | Constraint | Description |
|--------|-----------|--------|------------|-------------|
| **id** | INT | - | PK, AUTO_INCREMENT | ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| **username** | VARCHAR | 50 | UNIQUE, NOT NULL | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (CK) |
| **email** | VARCHAR | 100 | UNIQUE, NOT NULL | ‡∏≠‡∏µ‡πÄ‡∏°‡∏• (CK) |
| **phone** | VARCHAR | 20 | - | ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå |
| **firstName** | VARCHAR | 100 | NOT NULL | ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á |
| **lastName** | VARCHAR | 100 | NOT NULL | ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• |
| **password** | VARCHAR | 255 | NOT NULL | ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (hashed) |
| **isAdmin** | BOOLEAN | - | DEFAULT FALSE | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö |
| **createdAt** | TIMESTAMP | - | DEFAULT CURRENT_TIMESTAMP | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| **updatedAt** | TIMESTAMP | - | ON UPDATE CURRENT_TIMESTAMP | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï |

**Indexes:**
- PRIMARY KEY: `id`
- UNIQUE KEY: `username`, `email`

**Business Rules:**
- `username`: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß 4-50 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£, ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥
- `email`: ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á, ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥
- `password`: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
- `isAdmin = TRUE`: ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö, `FALSE`: ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤

---

### **Table: fields**
| Column | Data Type | Length | Constraint | Description |
|--------|-----------|--------|------------|-------------|
| **id** | INT | - | PK, AUTO_INCREMENT | ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏ô‡∏≤‡∏° |
| **fieldType** | VARCHAR | 50 | NOT NULL | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏ô‡∏≤‡∏° |
| **name** | VARCHAR | 100 | UNIQUE, NOT NULL | ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ô‡∏≤‡∏° (CK) |
| **description** | TEXT | 2000 | - | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
| **price** | DECIMAL | 10,2 | NOT NULL | ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á |
| **location** | VARCHAR | 200 | - | ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á |
| **imageUrl** | VARCHAR | 500 | - | URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û |
| **status** | VARCHAR | 20 | DEFAULT 'available' | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ |
| **capacity** | INT | - | DEFAULT 0 | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö |
| **operatingHours** | VARCHAR | 50 | - | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ |
| **createdAt** | TIMESTAMP | - | DEFAULT CURRENT_TIMESTAMP | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| **updatedAt** | TIMESTAMP | - | ON UPDATE CURRENT_TIMESTAMP | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï |

**Indexes:**
- PRIMARY KEY: `id`
- UNIQUE KEY: `name`

**Status Values:**
- `available`: ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
- `maintenance`: ‡∏õ‡∏¥‡∏î‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á
- `reserved`: ‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß
- `inactive`: ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

**Business Rules:**
- `price` > 0
- `operatingHours` format: "HH:MM-HH:MM"

---

### **Table: bookings**
| Column | Data Type | Length | Constraint | Description |
|--------|-----------|--------|------------|-------------|
| **bookingId** | INT | - | PK, AUTO_INCREMENT | ‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á |
| **userId** | INT | - | FK ‚Üí users(id), NOT NULL | ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| **bookingDate** | DATE | - | NOT NULL | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á |
| **startTime** | TIME | - | NOT NULL | ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô |
| **endTime** | TIME | - | NOT NULL | ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î |
| **status** | VARCHAR | 20 | DEFAULT 'pending' | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á |
| **fieldType** | VARCHAR | 50 | NOT NULL | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏ô‡∏≤‡∏° |
| **totalPrice** | INT | - | NOT NULL | ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó) |
| **createdAt** | TIMESTAMP | - | DEFAULT CURRENT_TIMESTAMP | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| **paymentStatus** | VARCHAR | 20 | DEFAULT 'unpaid' | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô |
| **updatedAt** | TIMESTAMP | - | ON UPDATE CURRENT_TIMESTAMP | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï |

**Indexes:**
- PRIMARY KEY: `bookingId`
- FOREIGN KEY: `userId` REFERENCES `users(id)` ON DELETE CASCADE

**Status Values:**
- `pending`: ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
- `confirmed`: ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß
- `cancelled`: ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
- `completed`: ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô

**Payment Status Values:**
- `unpaid`: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏à‡πà‡∏≤‡∏¢
- `paid`: ‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß
- `refunded`: ‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß

**Business Rules:**
- `endTime` > `startTime`
- `bookingDate` >= CURRENT_DATE
- `totalPrice` > 0
- `fieldType` ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ñ‡∏∂‡∏á `fields.fieldType` (‡πÑ‡∏°‡πà‡∏°‡∏µ FK constraint)

---

### **Table: payments**
| Column | Data Type | Length | Constraint | Description |
|--------|-----------|--------|------------|-------------|
| **paymentId** | INT | - | PK, AUTO_INCREMENT | ‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô |
| **bookingId** | INT | - | FK ‚Üí bookings(bookingId), NOT NULL | ‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á |
| **amount** | DECIMAL | 10,2 | NOT NULL | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô |
| **paymentMethod** | VARCHAR | 30 | NOT NULL | ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô |
| **transactionId** | VARCHAR | 100 | UNIQUE | ‡∏£‡∏´‡∏±‡∏™‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏° (CK) |
| **paymentStatus** | VARCHAR | 20 | DEFAULT 'pending' | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô |
| **paymentDate** | TIMESTAMP | - | DEFAULT CURRENT_TIMESTAMP | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô |
| **createdAt** | TIMESTAMP | - | DEFAULT CURRENT_TIMESTAMP | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| **updatedAt** | TIMESTAMP | - | ON UPDATE CURRENT_TIMESTAMP | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï |

**Indexes:**
- PRIMARY KEY: `paymentId`
- FOREIGN KEY: `bookingId` REFERENCES `bookings(bookingId)` ON DELETE CASCADE
- UNIQUE KEY: `transactionId`

**Payment Method Values:**
- `qrCode`: QR Code Payment
- `bankTransfer`: Bank Transfer
- `creditCard`: Credit Card
- `cash`: Cash Payment

**Payment Status Values:**
- `pending`: ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
- `completed`: ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- `failed`: ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
- `refunded`: ‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß

**Business Rules:**
- `amount` ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö `bookings.totalPrice`
- `transactionId` generate ‡∏à‡∏≤‡∏Å payment gateway (unique)
- `paymentDate` auto-set ‡πÄ‡∏°‡∏∑‡πà‡∏≠ status = 'completed'

---

## ÔøΩ **Relationships & Multiplicity**

### **1. User ‚Üí Booking (One-to-Many)**
```
User (1) ‚îÄ‚îÄ‚îÄ‚îÄmakes‚îÄ‚îÄ‚îÄ‚ñ∂ Booking (0..*)
```
- **Cardinality:** ‡∏´‡∏ô‡∏∂‡πà‡∏á User ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á
- **Foreign Key:** `bookings.userId` ‚Üí `users.id`
- **Delete Rule:** CASCADE (‡∏•‡∏ö User ‡∏à‡∏∞‡∏•‡∏ö Bookings ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
- **Business Rule:** User ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∂‡∏á‡∏à‡∏∞‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ

**SQL Constraint:**
```sql
ALTER TABLE bookings 
ADD CONSTRAINT fk_booking_user 
FOREIGN KEY (userId) REFERENCES users(id) 
ON DELETE CASCADE ON UPDATE CASCADE;
```

---

### **2. Booking ‚Üí Payment (One-to-One/Zero)**
```
Booking (1) ‚îÄ‚îÄ‚îÄ‚îÄhas‚îÄ‚îÄ‚îÄ‚ñ∂ Payment (0..1)
```
- **Cardinality:** ‡∏´‡∏ô‡∏∂‡πà‡∏á Booking ‡∏°‡∏µ 0 ‡∏´‡∏£‡∏∑‡∏≠ 1 Payment
- **Foreign Key:** `payments.bookingId` ‚Üí `bookings.bookingId`
- **Delete Rule:** CASCADE (‡∏•‡∏ö Booking ‡∏à‡∏∞‡∏•‡∏ö Payment)
- **Business Rule:** Payment ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Booking ‡∏ñ‡∏π‡∏Å‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß

**SQL Constraint:**
```sql
ALTER TABLE payments 
ADD CONSTRAINT fk_payment_booking 
FOREIGN KEY (bookingId) REFERENCES bookings(bookingId) 
ON DELETE CASCADE ON UPDATE CASCADE;
```

---

### **3. Field ‚Üî Booking (Loose Reference)**
```
Field ¬∑¬∑¬∑¬∑¬∑¬∑references¬∑¬∑¬∑¬∑¬∑¬∑ Booking
      (fieldType)    (fieldType)
```
- **Cardinality:** ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÅ‡∏ö‡∏ö FK ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
- **Reference:** `bookings.fieldType` ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á `fields.fieldType` (String)
- **Business Rule:** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ fieldType ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô fields ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á booking
- **Note:** ‡πÑ‡∏°‡πà‡∏°‡∏µ CASCADE delete behavior

**‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï:**
```sql
-- ‡πÄ‡∏û‡∏¥‡πà‡∏° field_id ‡πÉ‡∏ô bookings
ALTER TABLE bookings ADD COLUMN field_id INT;
ALTER TABLE bookings 
ADD CONSTRAINT fk_booking_field 
FOREIGN KEY (field_id) REFERENCES fields(id);
```

---

## üîë **Keys Summary**

### **Primary Keys (PK)**
| Table | Primary Key | Type | Auto Increment |
|-------|-------------|------|----------------|
| users | id | INT | ‚úÖ |
| fields | id | INT | ‚úÖ |
| bookings | bookingId | INT | ‚úÖ |
| payments | paymentId | INT | ‚úÖ |

### **Foreign Keys (FK)**
| Child Table | FK Column | Parent Table | Parent Column | On Delete | On Update |
|-------------|-----------|--------------|---------------|-----------|-----------|
| bookings | userId | users | id | CASCADE | CASCADE |
| payments | bookingId | bookings | bookingId | CASCADE | CASCADE |

### **Candidate Keys (CK) - Unique Constraints**
| Table | Column | Purpose | Example |
|-------|--------|---------|---------|
| users | username | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥ | "narathip1707" |
| users | email | ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥ | "user@example.com" |
| fields | name | ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ô‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥ | "Barcelona Stadium 1" |
| payments | transactionId | ‡∏£‡∏´‡∏±‡∏™‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥ | "TXN_20250105_001234" |

---

## üìê **Entity Relationship Diagram (ERD Style)**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           users                 ‚îÇ
‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
‚îÇ üîë id (PK)                      ‚îÇ
‚îÇ üîí username (UK)                ‚îÇ
‚îÇ üîí email (UK)                   ‚îÇ
‚îÇ    phone                        ‚îÇ
‚îÇ    firstName                    ‚îÇ
‚îÇ    lastName                     ‚îÇ
‚îÇ    password                     ‚îÇ
‚îÇ    isAdmin                      ‚îÇ
‚îÇ    createdAt                    ‚îÇ
‚îÇ    updatedAt                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ 1
          ‚îÇ makes
          ‚îÇ
          ‚îÇ 0..*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         bookings                ‚îÇ
‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
‚îÇ üîë bookingId (PK)               ‚îÇ
‚îÇ üîó userId (FK ‚Üí users)          ‚îÇ
‚îÇ    bookingDate                  ‚îÇ
‚îÇ    startTime                    ‚îÇ
‚îÇ    endTime                      ‚îÇ
‚îÇ    status                       ‚îÇ
‚îÇ    fieldType                    ‚îÇ
‚îÇ    totalPrice                   ‚îÇ
‚îÇ    createdAt                    ‚îÇ
‚îÇ    paymentStatus                ‚îÇ
‚îÇ    updatedAt                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ 1
          ‚îÇ has
          ‚îÇ
          ‚îÇ 0..1
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         payments                ‚îÇ
‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
‚îÇ üîë paymentId (PK)               ‚îÇ
‚îÇ üîó bookingId (FK ‚Üí bookings)    ‚îÇ
‚îÇ    amount                       ‚îÇ
‚îÇ    paymentMethod                ‚îÇ
‚îÇ üîí transactionId (UK)           ‚îÇ
‚îÇ    paymentStatus                ‚îÇ
‚îÇ    paymentDate                  ‚îÇ
‚îÇ    createdAt                    ‚îÇ
‚îÇ    updatedAt                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           fields                ‚îÇ
‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
‚îÇ üîë id (PK)                      ‚îÇ
‚îÇ    fieldType                    ‚îÇ
‚îÇ üîí name (UK)                    ‚îÇ
‚îÇ    description                  ‚îÇ
‚îÇ    price                        ‚îÇ
‚îÇ    location                     ‚îÇ
‚îÇ    imageUrl                     ‚îÇ
‚îÇ    status                       ‚îÇ
‚îÇ    capacity                     ‚îÇ
‚îÇ    operatingHours               ‚îÇ
‚îÇ    createdAt                    ‚îÇ
‚îÇ    updatedAt                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îä (loose reference)
          ‚îä fieldType
          ‚îä
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ   bookings  ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Legend:
üîë = Primary Key
üîó = Foreign Key  
üîí = Unique Constraint (Candidate Key)
```

---

## üéØ **Business Logic & Validation Rules**

### **User Validation**
```java
public boolean isValid() {
    // Username: 4-50 characters, unique
    if (username == null || username.trim().isEmpty() || 
        username.length() < 4 || username.length() > 50) {
        return false;
    }
    
    // Email: valid format, unique
    if (email == null || !email.matches("[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}")) {
        return false;
    }
    
    // Password: minimum 8 characters
    if (password == null || password.length() < 8) {
        return false;
    }
    
    return true;
}
```

### **Booking Validation**
```java
public boolean validateBookingTime() {
    // Check if endTime is after startTime
    if (endTime.before(startTime)) {
        return false;
    }
    
    // Check if booking date is not in the past
    if (bookingDate.before(new Date())) {
        return false;
    }
    
    // Check if totalPrice is positive
    if (totalPrice <= 0) {
        return false;
    }
    
    return true;
}

public boolean isOverlapping(Booking other) {
    // Check if two bookings overlap in time
    return this.bookingDate.equals(other.bookingDate) &&
           this.fieldType.equals(other.fieldType) &&
           !(this.endTime.before(other.startTime) || 
             this.startTime.after(other.endTime));
}
```

### **Payment Validation**
```java
public boolean validateAmount() {
    // Payment amount must match booking total price
    Booking booking = getBookingById(this.bookingId);
    return this.amount == booking.getTotalPrice();
}

public String generateTransactionId() {
    // Format: TXN_YYYYMMDD_HHMMSS_RANDOM
    SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd_HHmmss");
    String timestamp = sdf.format(new Date());
    String random = String.format("%06d", new Random().nextInt(1000000));
    return "TXN_" + timestamp + "_" + random;
}
```

---

## üîÑ **State Transitions**

### **Booking Status Flow**
```
    [New Booking]
         ‚îÇ
         ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ pending ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ Initial state
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚ñº          ‚ñº         ‚ñº
confirmed  cancelled  expired
    ‚îÇ
    ‚ñº
completed
```

**Valid Transitions:**
- `pending ‚Üí confirmed` (when admin approves)
- `pending ‚Üí cancelled` (user cancels)
- `pending ‚Üí expired` (timeout)
- `confirmed ‚Üí cancelled` (admin cancels)
- `confirmed ‚Üí completed` (after booking date)

### **Payment Status Flow**
```
    [New Payment]
         ‚îÇ
         ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ pending ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ Initial state
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚ñº         ‚ñº         ‚ñº
completed  failed   refunded
```

**Valid Transitions:**
- `pending ‚Üí completed` (successful payment)
- `pending ‚Üí failed` (payment error)
- `completed ‚Üí refunded` (refund request)

---

## üîç **Implementation Notes**

### **üéØ Current Implementation (‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏£‡∏¥‡∏á)**
- ‚úÖ ‡∏°‡∏µ 4 Model Classes: `User`, `Field`, `Booking`, `Payment`
- ‚úÖ User ‡πÉ‡∏ä‡πâ `isAdmin` flag ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å Customer/Admin classes
- ‚úÖ Booking ‡∏°‡∏µ FK ‡πÑ‡∏õ User (`userId`)
- ‚úÖ Payment ‡∏°‡∏µ FK ‡πÑ‡∏õ Booking (`bookingId`)
- ‚úÖ Field ‡πÄ‡∏õ‡πá‡∏ô standalone (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ FK relationship ‡∏Å‡∏±‡∏ö Booking)

### **‚ö†Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å Complete Class Diagram**

| Feature | Complete Design | Actual Implementation |
|---------|----------------|----------------------|
| **User Hierarchy** | Person ‚Üí Customer/Employee | User (with isAdmin flag) |
| **Employee Types** | BookingStaff, SystemAdmin, AccountingStaff, etc. | ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ |
| **Field Relationship** | Booking.field_id ‚Üí Field.id (FK) | Booking.fieldType ‚Üí Field.fieldType (String reference) |
| **Services** | Service, BookingDetail classes | ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ |
| **External Integration** | PaymentGateway, Logistic, Invoice | ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ (‡∏°‡∏µ‡πÅ‡∏Ñ‡πà Payment) |
| **Account Management** | Separate Account class | ‚ùå ‡∏£‡∏ß‡∏°‡πÉ‡∏ô User class |

### **üí° ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á (Future Enhancements)**

#### **1. ‡πÄ‡∏û‡∏¥‡πà‡∏° Field FK Constraint**
```sql
-- Step 1: Add field_id column
ALTER TABLE bookings ADD COLUMN field_id INT AFTER userId;

-- Step 2: Migrate data
UPDATE bookings b 
JOIN fields f ON b.fieldType = f.fieldType 
SET b.field_id = f.id;

-- Step 3: Add FK constraint
ALTER TABLE bookings 
ADD CONSTRAINT fk_booking_field 
FOREIGN KEY (field_id) REFERENCES fields(id)
ON DELETE RESTRICT ON UPDATE CASCADE;

-- Step 4: Keep fieldType for backward compatibility
-- ‡∏´‡∏£‡∏∑‡∏≠ DROP column ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß
```

#### **2. ‡πÅ‡∏¢‡∏Å Customer ‡πÅ‡∏•‡∏∞ Admin Classes**
```java
// Base User class
public abstract class User {
    protected int id;
    protected String username;
    protected String email;
    // ... common fields
}

// Customer extends User
public class Customer extends User {
    private int loyaltyPoints;
    private String membershipLevel;
    private Date registrationDate;
    
    public void makeBooking() { /* ... */ }
    public void viewHistory() { /* ... */ }
}

// Admin extends User
public class Admin extends User {
    private String department;
    private int accessLevel;
    
    public void manageUsers() { /* ... */ }
    public void approveBooking() { /* ... */ }
}
```

#### **3. ‡πÄ‡∏û‡∏¥‡πà‡∏° Service ‡πÅ‡∏•‡∏∞ BookingDetail**
```java
public class Service {
    private int serviceId;
    private int fieldId; // FK to Field
    private String serviceName;
    private double servicePrice;
    // ... other fields
}

public class BookingDetail {
    private int detailId;
    private int bookingId; // FK to Booking
    private int serviceId; // FK to Service
    private int quantity;
    private double unitPrice;
    private double subtotal;
}
```

#### **4. ‡πÄ‡∏û‡∏¥‡πà‡∏° Payment Gateway Integration**
```java
public class PaymentGateway {
    private int gatewayId;
    private String gatewayName; // "PromptPay", "SCB", "KBank"
    private String apiEndpoint;
    private String apiKey;
    private boolean isActive;
    
    public String initializePayment(Payment payment) { /* ... */ }
    public boolean confirmPayment(String transactionId) { /* ... */ }
}
```

---

## üìÅ **‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ**

```
‚úÖ ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß:
src/java/model/
‚îú‚îÄ‚îÄ User.java           ‚úÖ (id, username, email, password, isAdmin, ...)
‚îú‚îÄ‚îÄ Field.java          ‚úÖ (id, fieldType, name, price, status, ...)
‚îú‚îÄ‚îÄ Booking.java        ‚úÖ (bookingId, userId, bookingDate, totalPrice, ...)
‚îî‚îÄ‚îÄ Payment.java        ‚úÖ (paymentId, bookingId, amount, paymentStatus, ...)

‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï):
‚îú‚îÄ‚îÄ Person.java         ‚ùå (Abstract base class)
‚îú‚îÄ‚îÄ Customer.java       ‚ùå (extends User)
‚îú‚îÄ‚îÄ Employee.java       ‚ùå (extends User)
‚îú‚îÄ‚îÄ Admin.java          ‚ùå (extends Employee)
‚îú‚îÄ‚îÄ Service.java        ‚ùå (Additional services for fields)
‚îú‚îÄ‚îÄ BookingDetail.java  ‚ùå (Many-to-many: Booking ‚Üî Service)
‚îú‚îÄ‚îÄ PaymentGateway.java ‚ùå (Payment gateway integration)
‚îú‚îÄ‚îÄ Invoice.java        ‚ùå (Financial records)
‚îî‚îÄ‚îÄ Logistic.java       ‚ùå (Delivery management)
```

---

## üöÄ **Quick Start - ‡∏ß‡∏≤‡∏î Class Diagram ‡πÉ‡∏ô Draw.io**

### **Step 1: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Draw.io**
1. ‡πÄ‡∏õ‡∏¥‡∏î https://app.diagrams.net/
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Blank Diagram"
3. ‡πÄ‡∏õ‡∏¥‡∏î Shape Library: More Shapes ‚Üí Software ‚Üí UML

### **Step 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Classes (4 classes)**
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ class:
1. ‡∏•‡∏≤‡∏Å "Class" shape ‡∏°‡∏≤‡∏ß‡∏≤‡∏á
2. ‡∏Å‡∏î Double-click ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠ class
3. ‡πÄ‡∏û‡∏¥‡πà‡∏° Attributes (‡∏î‡∏π‡∏à‡∏≤‡∏Å PlantUML code ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô)
4. ‡πÄ‡∏û‡∏¥‡πà‡∏° Methods (‡∏î‡∏π‡∏à‡∏≤‡∏Å PlantUML code ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô)

### **Step 3: ‡∏ß‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå**
1. **User ‚Üí Booking:** 
   - ‡πÉ‡∏ä‡πâ Association arrow (solid line with arrow)
   - Label: "makes"
   - Multiplicity: "1" ‡∏ó‡∏µ‡πà User, "0..*" ‡∏ó‡∏µ‡πà Booking

2. **Booking ‚Üí Payment:**
   - ‡πÉ‡∏ä‡πâ Association arrow
   - Label: "has"
   - Multiplicity: "1" ‡∏ó‡∏µ‡πà Booking, "0..1" ‡∏ó‡∏µ‡πà Payment

3. **FK Links:**
   - ‡πÉ‡∏ä‡πâ Dependency arrow (dashed line)
   - User ‚îÑ‚îÑ‚îÑ‚ñ∂ Booking (userId)
   - Booking ‚îÑ‚îÑ‚îÑ‚ñ∂ Payment (bookingId)

### **Step 4: ‡∏à‡∏±‡∏î Layout**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  User   ‚îÇ                    ‚îÇ  Field  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ 1
     ‚îÇ makes
     ‚îÇ 0..*
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Booking  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ 1
     ‚îÇ has
     ‚îÇ 0..1
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Payment  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **Step 5: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î**
- ‡πÉ‡∏™‡πà stereotype: `<<PK>>`, `<<FK>>`, `<<UK>>`
- ‡πÉ‡∏™‡πà data types: `int`, `String(50)`, `Date`, `Timestamp`
- ‡πÉ‡∏™‡πà access modifiers: `-` (private), `+` (public)

### **Step 6: Export**
- File ‚Üí Export as ‚Üí PNG (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£)
- File ‚Üí Export as ‚Üí PDF (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠)
- File ‚Üí Save (XML format ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á)

---

## ‚è±Ô∏è **‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì**

| Task | Time | Difficulty |
|------|------|-----------|
| ‡∏ß‡∏≤‡∏î 4 classes ‡∏û‡∏£‡πâ‡∏≠‡∏° attributes | 30-45 ‡∏ô‡∏≤‡∏ó‡∏µ | ‚≠ê‚≠ê |
| ‡πÄ‡∏û‡∏¥‡πà‡∏° methods ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î | 20-30 ‡∏ô‡∏≤‡∏ó‡∏µ | ‚≠ê‚≠ê |
| ‡∏ß‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÅ‡∏•‡∏∞ FK links | 15-20 ‡∏ô‡∏≤‡∏ó‡∏µ | ‚≠ê‚≠ê |
| ‡∏à‡∏±‡∏î layout ‡πÅ‡∏•‡∏∞‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á | 15-20 ‡∏ô‡∏≤‡∏ó‡∏µ | ‚≠ê |
| ‡πÄ‡∏û‡∏¥‡πà‡∏° notes ‡πÅ‡∏•‡∏∞ constraints | 10-15 ‡∏ô‡∏≤‡∏ó‡∏µ | ‚≠ê |
| **‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î** | **1.5-2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á** | ‚≠ê‚≠ê |

---

## ‚úÖ **Checklist ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Class Diagram**

### **Classes (4 classes)**
- [ ] User class (complete with all attributes + methods)
- [ ] Field class (complete with all attributes + methods)  
- [ ] Booking class (complete with all attributes + methods)
- [ ] Payment class (complete with all attributes + methods)

### **Attributes**
- [ ] ‡∏ó‡∏∏‡∏Å attribute ‡∏°‡∏µ data type + length
- [ ] ‡∏ó‡∏∏‡∏Å PK ‡∏°‡∏µ `{PK}` marker
- [ ] ‡∏ó‡∏∏‡∏Å FK ‡∏°‡∏µ `{FK}` marker
- [ ] Candidate keys ‡∏°‡∏µ `{CK}` marker
- [ ] ‡∏°‡∏µ access modifiers (- for private)

### **Methods**
- [ ] Getter methods ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å attribute
- [ ] Setter methods ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å attribute
- [ ] Business methods (getFullName, isValid, calculateDuration, etc.)
- [ ] ‡∏°‡∏µ return types ‡πÅ‡∏•‡∏∞ parameters ‡∏Ñ‡∏£‡∏ö

### **Relationships**
- [ ] User ‚Üí Booking (1 to 0..*)
- [ ] Booking ‚Üí Payment (1 to 0..1)
- [ ] ‡πÉ‡∏™‡πà multiplicity ‡∏Ñ‡∏£‡∏ö
- [ ] ‡πÉ‡∏™‡πà relationship names (makes, has)

### **FK Links**
- [ ] User ‚îÑ‚ñ∂ Booking (userId)
- [ ] Booking ‚îÑ‚ñ∂ Payment (bookingId)
- [ ] ‡πÉ‡∏ä‡πâ dashed lines

### **Notes & Documentation**
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° notes ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ status values
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° constraints ‡πÅ‡∏•‡∏∞ business rules
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° legend ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ symbols

---

## üéì **Tips ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏î**

1. **‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å User class** (‡πÄ‡∏õ‡πá‡∏ô root ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö)
2. **‡∏ß‡∏≤‡∏î Booking ‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å User** (main entity)
3. **‡∏ß‡∏≤‡∏î Payment ‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å Booking** (dependent entity)
4. **‡∏ß‡∏≤‡∏á Field ‡πÅ‡∏¢‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å** (standalone)
5. **‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡∏™‡∏∏‡∏î**
6. **‡πÉ‡∏™‡πà‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢**

**‡πÉ‡∏ä‡πâ PlantUML code ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏õ‡πá‡∏ô reference ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö!** ÔøΩ